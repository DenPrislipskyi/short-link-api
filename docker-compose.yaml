services:
    short-link-api:
      build: .
      restart: unless-stopped
      ports:
        - "8080:8080"
      depends_on:
        db:
          condition: service_healthy

    db:
      image: postgres:14-alpine
      restart: unless-stopped
      ports:
        - "5434:5432"
      env_file:
        - .env
      healthcheck:
        test: [ "CMD-SHELL", "pg_isready -d $$POSTGRES_DB -U $$POSTGRES_USER" ]
        interval: 10s
        timeout: 60s
        retries: 5
